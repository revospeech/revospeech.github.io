KEEP.initUtils=()=>{KEEP.utils={html_root_dom:document.querySelector("html"),pageContainer_dom:document.querySelector(".page-container"),pageTop_dom:document.querySelector(".page-main-content-top"),firstScreen_dom:document.querySelector(".first-screen-container"),scrollProgressBar_dom:document.querySelector(".scroll-progress-bar"),pjaxProgressBar_dom:document.querySelector(".pjax-progress-bar"),pjaxProgressIcon_dom:document.querySelector(".pjax-progress-icon"),back2TopButton_dom:document.querySelector(".tool-scroll-to-top"),headerWrapper_dom:document.querySelector(".header-wrapper"),innerHeight:window.innerHeight,pjaxProgressBarTimer:null,prevScrollValue:0,fontSizeLevel:0,isHasScrollProgressBar:!1,isHasScrollPercent:!1,isHeaderTransparent:!1,hasToc:!1,initData(){var{scroll:e,first_screen:t}=KEEP.theme_config.style,{enable:e,header_transparent:t}=(this.isHasScrollProgressBar=!0===e.progress_bar,this.isHasScrollPercent=!0===e.percent,t);this.isHeaderTransparent=!0===e&&!0===t},styleHandleWhenScroll(){var e=document.body.scrollTop||document.documentElement.scrollTop,t=document.body.scrollHeight||document.documentElement.scrollHeight,o=window.innerHeight||document.documentElement.clientHeight,s=Math.round(e/(t-o)*100);this.isHasScrollProgressBar&&(t=(e/(t-o)*100).toFixed(3),this.scrollProgressBar_dom.style.visibility=0===s?"hidden":"visible",this.scrollProgressBar_dom.style.width=t+"%"),this.isHasScrollPercent&&(o=this.back2TopButton_dom.querySelector(".percent"),0===s||void 0===s?this.back2TopButton_dom.classList.remove("show"):(this.back2TopButton_dom.classList.add("show"),o.innerHTML=s.toFixed(0))),e>this.prevScrollValue&&e>this.innerHeight?(this.pageTop_dom.classList.add("hide"),this.isHeaderTransparent&&this.headerWrapper_dom.classList.remove("transparent-1","transparent-2")):(this.pageTop_dom.classList.remove("hide"),this.isHeaderTransparent&&(e<=this.headerWrapper_dom.getBoundingClientRect().height?(this.headerWrapper_dom.classList.remove("transparent-2"),this.headerWrapper_dom.classList.add("transparent-1")):e<this.innerHeight&&this.headerWrapper_dom.classList.add("transparent-2"))),this.prevScrollValue=e},registerWindowScroll(){window.addEventListener("scroll",()=>{this.styleHandleWhenScroll(),KEEP.theme_config.toc.enable&&KEEP.utils.hasOwnProperty("findActiveIndexByTOC")&&KEEP.utils.findActiveIndexByTOC(),KEEP.utils.headerShrink.headerShrink()})},toggleShowToolsList(){const t=document.querySelector(".side-tools-list");document.querySelector(".tool-toggle-show").addEventListener("click",e=>{t.classList.toggle("show"),e.stopPropagation()}),t.querySelectorAll(".tools-item").forEach(e=>{e.addEventListener("click",e=>{e.stopPropagation()})}),document.addEventListener("click",()=>{t.classList.contains("show")&&t.classList.remove("show")})},globalFontAdjust(){var e=document.defaultView.getComputedStyle(document.body).fontSize;const t=parseFloat(e);const o=e=>{this.html_root_dom.style.fontSize=t*(1+.05*e)+"px",KEEP.styleStatus.fontSizeLevel=e,KEEP.setStyleStatus()};(e=KEEP.getStyleStatus())&&(this.fontSizeLevel=e.fontSizeLevel,o(this.fontSizeLevel)),document.querySelector(".tool-font-adjust-plus").addEventListener("click",()=>{5!==this.fontSizeLevel&&(this.fontSizeLevel++,o(this.fontSizeLevel))}),document.querySelector(".tool-font-adjust-minus").addEventListener("click",()=>{this.fontSizeLevel<=0||(this.fontSizeLevel--,o(this.fontSizeLevel))})},getElementHeight(e){e=document.querySelector(e);return e?e.getBoundingClientRect().height:0},initHasToc(){0<document.querySelectorAll(".post-toc-wrap .post-toc li").length?(this.hasToc=!0,document.body.classList.add("has-toc")):(this.hasToc=!1,document.body.classList.remove("has-toc"))},initPageHeightHandle(){var e,t,o;this.firstScreen_dom||(e=this.getElementHeight(".page-main-content-top")+this.getElementHeight(".page-main-content-middle")+this.getElementHeight(".page-main-content-bottom"),o=window.innerHeight,t=document.querySelector(".page-main-content-bottom"),e<o&&0<(o=Math.floor(o-e))&&(t.style.marginTop=o-2+"px"))},zoomInImage(){let d=40,h=!1,g=0,m=null;var e=document.querySelectorAll(".keep-markdown-body img");const u=document.querySelector(".zoom-in-image-mask"),p=u.querySelector(".zoom-in-image"),t=()=>{h&&(h=!1,g=0,p&&(p.style.transform="scale(1)"),u&&u.classList.remove("show"),setTimeout(()=>{m&&m.classList.remove("hide")},300))};e.length&&(u&&u.addEventListener("click",()=>{t()}),document.addEventListener("scroll",()=>{h&&50<=Math.abs(g-window.scrollY)&&t()}),e.forEach(c=>{c.addEventListener("click",()=>{var e,t,o,s,r,i,a,n,l;g=window.scrollY,h=!h,e=document.body.offsetWidth,d=e<=500?10:e<=800?20:40,p.setAttribute("src",c.getAttribute("src")),m=c,h&&(t=(e=m.getBoundingClientRect()).width,o=e.height,s=e.left,r=e.top,a=((a=(l=document.body.offsetWidth-2*d)/t)<(n=(i=document.body.offsetHeight-2*d)/o)?a:n)||1,n=l/2-(e.x+t/2)+d,l=i/2-(e.y+o/2)+d,m.classList.add("hide"),u.classList.add("show"),p.style.top=r+"px",p.style.left=s+"px",p.style.width=t+"px",p.style.height=o+"px",p.style.transform=`translateX(${n}px) translateY(${l}px) scale(${a}) `)})}))},setHowLongAgoLanguage(e,t){return t.replace(/%s/g,e)},getHowLongAgo(e){var t=KEEP.language_ago,o=Math.floor(e/2592e3/12),s=Math.floor(e/2592e3),r=Math.floor(e/86400/7),i=Math.floor(e/86400),a=Math.floor(e/3600%24),n=Math.floor(e/60%60),e=Math.floor(e%60);return 0<o?this.setHowLongAgoLanguage(o,t.year):0<s?this.setHowLongAgoLanguage(s,t.month):0<r?this.setHowLongAgoLanguage(r,t.week):0<i?this.setHowLongAgoLanguage(i,t.day):0<a?this.setHowLongAgoLanguage(a,t.hour):0<n?this.setHowLongAgoLanguage(n,t.minute):0<e?this.setHowLongAgoLanguage(e,t.second):void 0},setHowLongAgoInHome(){var e=document.querySelectorAll(".home-article-meta-info .home-article-date");e&&e.forEach(e=>{var t=Date.now(),o=new Date(e.dataset.updated.split(" GMT")[0]).getTime();e.innerHTML=this.getHowLongAgo(Math.floor((t-o)/1e3))})},pjaxProgressBarStart(){this.pjaxProgressBarTimer&&clearInterval(this.pjaxProgressBarTimer),this.isHasScrollProgressBar&&this.scrollProgressBar_dom.classList.add("hide"),this.pjaxProgressBar_dom.style.width="0",this.pjaxProgressIcon_dom.classList.add("show");let e=1;this.pjaxProgressBar_dom.classList.add("show"),this.pjaxProgressBar_dom.style.width=e+"%",this.pjaxProgressBarTimer=setInterval(()=>{99<(e+=5)&&(e=99),this.pjaxProgressBar_dom.style.width=e+"%"},100)},pjaxProgressBarEnd(){this.pjaxProgressBarTimer&&clearInterval(this.pjaxProgressBarTimer),this.pjaxProgressBar_dom.style.width="100%";const t=setTimeout(()=>{this.pjaxProgressBar_dom.classList.remove("show"),this.pjaxProgressIcon_dom.classList.remove("show"),this.isHasScrollProgressBar&&this.scrollProgressBar_dom.classList.remove("hide");const e=setTimeout(()=>{this.pjaxProgressBar_dom.style.width="0",clearTimeout(t),clearTimeout(e)},200)},200)},insertTooltipContent(){const e=()=>{document.querySelectorAll(".tooltip").forEach(e=>{var{content:t,offsetX:o,offsetY:s}=e.dataset;let r="",i="",a="";o&&(i=`left: ${o};`),s&&(a=`top: ${s};`),(o||s)&&(r=` style="${a}${i}"`),t&&e.insertAdjacentHTML("afterbegin",`<span class="tooltip-content"${r}>${t}</span>`)});const l={};document.querySelectorAll(".tooltip-img").forEach((r,e)=>{var t,o,{imgUrl:s,name:i}=r.dataset;if(s){const a="tooltip-img-"+i,n=i+"_"+e;e=`<div class="tooltip-img-box">${`<img class="${a}" lazyload data-src="${s}" alt="${i}">`}</div>`;l[n]={imgLoaded:!1,isShowImg:!1},r.insertAdjacentHTML("afterbegin",e),r.addEventListener("click",e=>{if(!l[n].imgLoaded){var t=document.querySelector(".tooltip-img-box img."+a);l[n].imgLoaded;var o=new Image;const s=t.dataset["src"];o.src=s,o.onload=()=>{t.src=s,t.removeAttribute("lazyload")}}l[n].isShowImg=!l[n].isShowImg,r.classList.toggle("show-img"),e.stopPropagation()}),t=r,o=n,document.addEventListener("click",()=>{l[o].isShowImg&&(t.classList.remove("show-img"),l[o].isShowImg=!1)})}})};setTimeout(()=>{e()},1e3)}},KEEP.utils.initData(),KEEP.utils.registerWindowScroll(),KEEP.utils.toggleShowToolsList(),KEEP.utils.globalFontAdjust(),KEEP.utils.initPageHeightHandle(),KEEP.utils.initHasToc(),KEEP.utils.zoomInImage(),KEEP.utils.setHowLongAgoInHome(),KEEP.utils.insertTooltipContent()};