function initToggleShowToc(){KEEP.utils.postHelper={postPageContainerDom:document.querySelector(".post-page-container"),toggleShowTocBtnDom:document.querySelector(".toggle-show-toc"),toggleShowTocIcon:document.querySelector(".toggle-show-toc i"),mainContentDom:document.querySelector(".main-content"),postToolsDom:document.querySelector(".post-tools"),goToCommentsDom:document.querySelector(".post-tools .go-to-comments"),isShowToc:!1,initToggleToc(){this.toggleShowTocBtnDom&&this.toggleShowTocBtnDom.addEventListener("click",()=>{this.isShowToc=!this.isShowToc,KEEP.styleStatus.isShowToc=this.isShowToc,KEEP.setStyleStatus(),this.handleToggleToc(this.isShowToc)})},handleToggleToc(t){t?(this.postPageContainerDom.classList.add("show-toc"),document.body.classList.add("has-toc")):(this.postPageContainerDom.classList.remove("show-toc"),document.body.classList.remove("has-toc")),setTimeout(()=>{this.setPostToolsLeft()},120)},hasToc(t){this.toggleShowTocBtnDom.style.display="flex",this.isShowToc=t,this.handleToggleToc(t)},setPostToolsLeft(t){t=t||this.mainContentDom.getBoundingClientRect().width.toFixed(0);let o=5;window.innerWidth<=800&&(o=3),this.postToolsDom.style.opacity="1",this.postToolsDom.style.left=`calc((100vw - ${t}px) / 2 - ${o}rem)`},initSetPostToolsLeft(){setTimeout(()=>{this.setPostToolsLeft()},150),window.addEventListener("resize",()=>{this.setPostToolsLeft()})},goToComments(){const o=document.querySelector("#comments-anchor");this.goToCommentsDom&&o&&this.goToCommentsDom.addEventListener("click",t=>{t.preventDefault();t=0===(t=window.scrollY)?-20:t,t=o.getBoundingClientRect().top+t;window.anime({targets:document.scrollingElement,duration:300,easing:"linear",scrollTop:t,complete:()=>{setTimeout(()=>{KEEP.utils.pageTop_dom.classList.add("hide")},150)}})})},watchPostCommentsCount(){const o=this.postToolsDom.querySelector(".post-comments-count");if(!o)return;const e=new MutationObserver(function(t){t.forEach(t=>{"childList"===t.type&&0<(t=Number(t.target.innerHTML))&&(o.style.display="flex",99<t)&&(o.innerHTML="99+",e.disconnect())})});e.observe(o,{attributes:!0,childList:!0})},initSetPostLink(){var t=document.querySelector(".copyright-info-content .post-link .content");t&&(t.innerHTML=decodeURI(window.location.href))},copyCopyrightInfo(){const e=document.querySelector(".copyright-info-content"),n=document.querySelector(".copy-copyright-info"),i=n.querySelector("i"),s=KEEP.language_copy_copyright,c="en"===KEEP.hexo_config.language?": ":"ï¼š";let l=!1;const r=(t,o,e,s)=>{i&&(i.classList.remove(t),i.classList.add(o));t=n.querySelector(".tooltip-content");t&&(t.innerHTML=e),l=s};n.addEventListener("click",()=>{var t,o;l||(o=e.querySelector(".post-author .content").innerHTML,t=e.querySelector(".post-link .content").innerHTML,o=""+s.author+c+o+`
`+s.link+c+t,navigator.clipboard.writeText(o).then(()=>{r("fa-copy","fa-check",s.copied,!0)}))}),n.addEventListener("mouseleave",()=>{setTimeout(()=>{r("fa-check","fa-copy",s.copy,!1)},500)})},setArticleAgingDays(){var t,o,e,s,n=document.querySelector(".article-content .article-aging-tips");n&&(t=n.querySelector(".days"),e=Date.now(),o=864e5*(n.dataset?.agingDays||30),s=((e=e-new Date(n.dataset.updateDate).getTime())/864e5).toFixed(0),o<=e)&&(t.innerHTML=s,n.style.display="block")}},KEEP.utils.postHelper.initSetPostToolsLeft(),KEEP.utils.postHelper.setArticleAgingDays(),!0===KEEP.theme_config.toc?.enable&&KEEP.utils.postHelper.initToggleToc(),!0===KEEP.theme_config.comment?.enable&&(KEEP.utils.postHelper.goToComments(),KEEP.utils.postHelper.watchPostCommentsCount()),!0===KEEP.theme_config.post?.copyright_info&&(KEEP.utils.postHelper.initSetPostLink(),KEEP.utils.postHelper.copyCopyrightInfo())}!0===KEEP.theme_config.pjax?.enable&&KEEP.utils?initToggleShowToc():window.addEventListener("DOMContentLoaded",initToggleShowToc);